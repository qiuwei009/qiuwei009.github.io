import{_ as z,a as S}from"./Btn.b5e2ce87.js";import{_ as F,c as A,b as E}from"./index.adc6711e.js";import{_ as M}from"./Jointlevel.1ebf8a5b.js";import{g as u,p as g,a as j}from"./request.9985e0c4.js";import{a as m}from"./element-plus.9dccbbcf.js";import{V as k,e as $,v as U,F as w,o as T,c as q,a as s,u as t,P as a,M as r,R as B,ap as D,aq as G}from"./@vue.807b2975.js";import"./vue-router.203fc809.js";import"./pinia.e364e968.js";import"./vue-demi.b3a9cad9.js";/* empty css                    */import"./amfe-flexible.30f45bbf.js";import"./jquery.310f556f.js";import"./axios.1257cc19.js";import"./lodash.19b22f64.js";import"./vite-plugin-mock.c101b59b.js";import"./mockjs.c44c5d1b.js";import"./path-to-regexp.3eda823b.js";import"./dayjs.af8763dd.js";import"./lodash-es.5d194466.js";import"./@vueuse.3d68ca19.js";import"./@element-plus.5dd6b289.js";import"./async-validator.5d25c98b.js";import"./@popperjs.7a88ba6a.js";import"./@ctrl.2e36ce53.js";import"./qs.cbfe7bae.js";import"./side-channel.ed271cce.js";import"./get-intrinsic.1675b33e.js";import"./has-symbols.caae0f97.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.0b5a4f26.js";import"./object-inspect.5a656981.js";const d=v=>(D("data-v-ec8f0f5e"),v=v(),G(),v),R={class:"role"},N={class:"col-4 card"},J={class:"h60 flex nowrap just-b align-c"},K={class:"h100-60"},O=d(()=>s("div",{class:"flex just-c align-c",style:{flex:"0 0 100px"}},"\u7F16\u8F91",-1)),Q={class:"flex",style:{flex:"0 0 100px"}},W={class:"cursor but text-color flex just-c",style:{width:"50%"}},X=["onClick"],Y={class:"cursor but text-color flex just-c",style:{width:"50%"}},Z=d(()=>s("i",{class:"iconfont iconfontHover icon-shanchu_o",title:"\u5220\u9664"},null,-1)),ee={class:"col-8 card"},te={class:"h60 flex nowrap just-b align-c"},se={class:"h100-60"},oe=d(()=>s("div",{class:"flex just-c align-c",style:{flex:"0 0 100px"}},"\u7F16\u8F91",-1)),ie={class:"flex",style:{flex:"0 0 100px"}},ne={class:"cursor but text-color flex just-c",style:{width:"50%"}},le=["onClick"],ae={class:"cursor but text-color flex just-c",style:{width:"50%"}},re=d(()=>s("i",{class:"iconfont iconfontHover icon-shanchu_o",title:"\u5220\u9664"},null,-1)),ce={class:"select condition"},de=d(()=>s("label",{for:"name"},"\u89D2\u8272\u6743\u9650",-1)),fe={class:"select condition"},ue=d(()=>s("label",{for:"name"},"\u7528\u6237\u7EC4\u540D",-1)),me=d(()=>s("label",{for:"name"},"\u7EC4\u7EC7\u63CF\u8FF0",-1)),pe=d(()=>s("div",{class:"flex just-c align-c",style:{flex:"0 0 100px"}},"\u7F16\u8F91",-1)),he={class:"flex",style:{flex:"0 0 100px"}},_e={class:"cursor but text-color flex just-c",style:{width:"50%"}},ge=["onClick"],ve={class:"cursor but text-color flex just-c",style:{width:"50%"}},ye=d(()=>s("i",{class:"iconfont iconfontHover icon-shanchu_o",title:"\u5220\u9664"},null,-1)),we={setup(v){const C=k({show:!1,point:"0,0",backPoint(i){console.log(i,"\u70B9")}}),y=$(null),l=k({list:{name:"roleList",header:[{name:"\u89D2\u8272\u6743\u9650",width:"20%",key:"name",color:"#9495a9"},{name:"\u89D2\u8272\u7F16\u7801",width:"20%",key:"code",color:"#9495a9"}],rows:[],page:1,size:20,total:1,currentPage:1,active:0,select:{open:!1,selectAll:!1,id:"",selectId:[]}},menus:{name:"menus",list:[],checkId:[],key:"menu",value:"functionId",child:"child",column:!1,single:!1},async getList(i){i==="search"&&(this.list.page=1);let e=await u("/manage/rrole/sarole",{page:this.list.page,size:this.list.size});e.status&&(this.list.rows=e.data.data,this.list.total=e.data.total,console.log(this.list.rows,"this.list.rows"))},handleCurrentChange(i){l.list.select.selectId=[],l.list.select.selectAll=!1,l.list.page=i.page,l.getList(null)},form:{id:"",name:"",code:"",remark:"",menuIds:"",status:"0"},rules:{name:[{required:!0,validator:(i,e,c)=>{e===""?c(new Error("\u8BF7\u8F93\u5165\u8D26\u6237\u540D\uFF01")):c()},trigger:"blur"}]},isDisable:!1,info:{show:!1,name:"roleInfo",w:"40%",type:"add"},async getInfo(i){if(i){let e=await u("/manage/rrole/sfunc",{roleId:i.id});e.status&&(this.form=_.clone(i),e.data.sort((c,f)=>c.functionId-f.functionId),this.menus.list=e.data,this.menus.checkId=[],e.data.forEach(c=>{c.bind&&this.menus.checkId.push(c.functionId)}),this.info.type="edit",this.info.show=!0)}else{let e=await u("/manage/rrole/sfunc");e.status&&(e.data.sort((c,f)=>c.functionId-f.functionId),this.menus.list=e.data,this.menus.checkId=[],this.info.type="edit",this.info.show=!0),this.form={},this.menus.checkId=[],this.info.type="add",this.info.show=!0}},submit(){y.value.validate(async i=>{if(i)console.log("\u901A\u8FC7"),this.info.type==="add"?(await g("/manage/crole/arole",{name:this.form.name,functions:this.menus.checkId.toString()})).status&&(this.info.show=!1,this.info.type="add",this.getList(),m({duration:1e3,type:"success",message:"\u65B0\u589E\u6210\u529F"})):this.info.type==="edit"&&(await g("/manage/urole/mrole",{name:this.form.name,functions:this.menus.checkId.toString(),id:this.form.id})).status&&(this.info.show=!1,this.info.type="add",this.getList(),m({duration:1e3,type:"success",message:"\u4FEE\u6539\u6210\u529F"}));else return console.log("\u4E0D\u901A\u8FC7"),!1})},hide(){y.value.resetFields(),this.info.show=!1},async del(i){(await g("/manage/drole/drole",{roleId:i.id})).status&&(this.getList(),m({duration:1e3,type:"success",message:"\u5220\u9664\u6210\u529F"}))}}),b=$(null),o=k({list:{name:"roleList",header:[{name:"\u89D2\u8272\u6743\u9650",width:"20%",key:"name",color:"#9495a9"},{name:"\u89D2\u8272\u7F16\u7801",width:"20%",key:"code",color:"#9495a9"}],rows:[],page:1,size:1e7,total:1,currentPage:1,active:0,select:{open:!1,selectAll:!1,id:"",selectId:[]}},async getList(i){i==="search"&&(this.list.page=1);let e=await u("/manage/rrole/showUserGroup",{page:this.list.page,size:this.list.size});e.status&&(this.list.rows=e.group,this.list.total=e.group.length,console.log(this.list.rows,"this.list.rows"))},handleCurrentChange(i){o.list.select.selectId=[],o.list.select.selectAll=!1,o.list.page=i.page,o.getList(null)},form:{id:"",name:"",code:"",remark:"",menuIds:"",status:"0"},rules:{name:[{required:!0,validator:(i,e,c)=>{e===""?c(new Error("\u8BF7\u8F93\u5165\u8D26\u6237\u540D\uFF01")):c()},trigger:"blur"}]},isDisable:!1,info:{show:!1,name:"roleInfo",w:"40%",type:"add"},userList:[],async getInfo(i){if(i){let e=await u("/manage/rrole/notBindList");e.status&&(this.userList=e.user,this.form=_.clone(i),this.info.type="edit",this.info.show=!0)}else{let e=await u("/manage/rrole/notBindList");e.status&&(this.userList=e.user),this.form={},this.info.type="add",this.info.show=!0}},submit(){b.value.validate(async i=>{if(i){if(console.log("\u901A\u8FC7"),this.info.type==="add")(await g("/manage/crole/addGroups",{name:this.form.name,userid:this.form.user.toString(),description:this.form.description})).status&&(this.info.show=!1,this.info.type="add",this.getList());else if(this.info.type==="edit"){let e=await j("/users/user",this.form.userForm,!0);if(e.code===200)if(this.form.userForm.password){let c=await j("/users/user/resetPwd",this.form.userForm,!0);c.code===200&&(this.info.show=!1,this.info.type="add",this.getList(),m({duration:1e3,type:"success",message:c.msg}))}else this.info.show=!1,this.info.type="add",this.getList(),m({duration:1e3,type:"success",message:e.msg})}}else return console.log("\u4E0D\u901A\u8FC7"),!1})},hide(){y.value.resetFields(),this.info.show=!1},async del(i){let e=await g("manage/drole/deleteGroup",{ids:i.groupid});e.status&&(this.getList(),m({duration:1e3,type:"success",message:e.message}))}});return U(()=>{l.getList(null),o.getList(null)}),(i,e)=>{const c=z,f=w("el-popconfirm"),I=A,x=w("el-input"),p=w("el-form-item"),V=M,L=w("el-form"),H=E,P=S;return T(),q("div",R,[s("div",N,[s("p",J,[s("span",{class:"select",onClick:e[0]||(e[0]=n=>t(l).getList())},"\u89D2\u8272"),a(c,{info:{id:3,name:t(l).list.active===0?"\u65B0\u589E\u89D2\u8272":"\u65B0\u589E\u7528\u6237\u7EC4",type:"add",class:"Btn",icon:"icon-RectangleCopy52",title:t(l).list.active===0?"\u65B0\u589E\u89D2\u8272":"\u65B0\u589E\u7528\u6237\u7EC4"},onHandleClick:e[1]||(e[1]=n=>t(l).getInfo(null))},null,8,["info"])]),s("div",K,[a(I,{list:t(l).list,onHandleCurrentChange:t(l).handleCurrentChange},{rightTitle:r(({item:n})=>[O]),rightBtn:r(({item:n})=>[s("div",Q,[s("div",W,[s("i",{class:"iconfont iconfontHover icon-bianji1",title:"\u7F16\u8F91",onClick:h=>t(l).getInfo(n)},null,8,X)]),s("div",Y,[a(f,{title:"\u60A8\u662F\u5426\u786E\u5B9A\u5220\u9664\u5F53\u524D\u89D2\u8272?",onCancel:e[2]||(e[2]=()=>{}),onConfirm:h=>t(l).del(n)},{reference:r(()=>[Z]),_:2},1032,["onConfirm"])])])]),_:1},8,["list","onHandleCurrentChange"])])]),s("div",ee,[s("p",te,[s("span",{class:"select",onClick:e[3]||(e[3]=n=>t(o).getList())},"\u7528\u6237"),a(c,{info:{id:3,name:t(o).list.active===0?"\u65B0\u589E\u7528\u6237":"\u65B0\u589E\u7528\u6237\u7EC4",type:"add",class:"Btn",icon:"icon-RectangleCopy52",title:t(o).list.active===0?"\u65B0\u589E\u7528\u6237":"\u65B0\u589E\u7528\u6237\u7EC4"},onHandleClick:e[4]||(e[4]=n=>t(o).getInfo(null))},null,8,["info"])]),s("div",se,[a(I,{list:t(o).list,onHandleCurrentChange:t(o).handleCurrentChange},{rightTitle:r(({item:n})=>[oe]),rightBtn:r(({item:n})=>[s("div",ie,[s("div",ne,[s("i",{class:"iconfont iconfontHover icon-bianji1",title:"\u7F16\u8F91",onClick:h=>t(o).getInfo(n)},null,8,le)]),s("div",ae,[a(f,{title:"\u60A8\u662F\u5426\u786E\u5B9A\u5220\u9664\u5F53\u524D\u89D2\u8272?",onCancel:e[5]||(e[5]=()=>{}),onConfirm:h=>t(o).del(n)},{reference:r(()=>[re]),_:2},1032,["onConfirm"])])])]),_:1},8,["list","onHandleCurrentChange"])])]),a(H,{info:t(l).info,onHide:e[8]||(e[8]=n=>t(l).hide())},{title:r(()=>[s("span",ce,B(t(l).info.type==="add"?"\u65B0\u589E\u89D2\u8272":"\u4FEE\u6539\u89D2\u8272"),1)]),main:r(()=>[a(L,{ref_key:"formIns",ref:y,model:t(l).form,rules:t(l).rules,class:"formIns"},{default:r(()=>[a(p,{class:"label",prop:"name"},{default:r(()=>[de,a(x,{id:"name",modelValue:t(l).form.name,"onUpdate:modelValue":e[6]||(e[6]=n=>t(l).form.name=n),type:"input"},null,8,["modelValue"])]),_:1}),a(p,{class:"label padding-10",prop:"data"},{default:r(()=>[a(V,{data:t(l).menus},null,8,["data"])]),_:1})]),_:1},8,["model","rules"])]),page:r(()=>[s("span",{class:"confirm_btn cursor",onClick:e[7]||(e[7]=n=>t(l).submit())},"\u786E\u5B9A")]),_:1},8,["info"]),a(H,{info:t(o).info,onHide:e[13]||(e[13]=n=>t(o).hide())},{title:r(()=>[s("span",fe,B(t(o).info.type==="add"?"\u65B0\u589E\u7528\u6237":"\u4FEE\u6539\u7528\u6237"),1)]),main:r(()=>[a(L,{ref_key:"formIns2",ref:b,model:t(o).form,rules:t(o).rules,class:"formIns flex column",style:{height:"calc(100vh - 160px)"}},{default:r(()=>[a(p,{class:"label",prop:"name"},{default:r(()=>[ue,a(x,{id:"name",modelValue:t(o).form.name,"onUpdate:modelValue":e[9]||(e[9]=n=>t(o).form.name=n),type:"input"},null,8,["modelValue"])]),_:1}),a(p,{class:"label",prop:"description"},{default:r(()=>[me,a(x,{id:"name",modelValue:t(o).form.description,"onUpdate:modelValue":e[10]||(e[10]=n=>t(o).form.description=n),type:"input"},null,8,["modelValue"])]),_:1}),a(p,{prop:"user",class:"col-auto"},{default:r(()=>[a(I,{list:{name:"roleList",header:[{name:"\u89D2\u8272\u6743\u9650",width:"20%",key:""},{name:"\u89D2\u8272\u7F16\u7801",width:"20%",key:""}],rows:t(o).form.groupUsers||[],page:1,size:1e7,total:1,currentPage:1,active:0,select:{open:!1,selectAll:!1,id:"",selectId:[]}},onHandleCurrentChange:t(o).handleCurrentChange},{rightTitle:r(({item:n})=>[pe]),rightBtn:r(({item:n})=>[s("div",he,[s("div",_e,[s("i",{class:"iconfont iconfontHover icon-bianji1",title:"\u7F16\u8F91",onClick:h=>t(o).getInfo(n)},null,8,ge)]),s("div",ve,[a(f,{title:"\u60A8\u662F\u5426\u786E\u5B9A\u5220\u9664\u5F53\u524D\u89D2\u8272?",onCancel:e[11]||(e[11]=()=>{}),onConfirm:h=>t(o).del(n)},{reference:r(()=>[ye]),_:2},1032,["onConfirm"])])])]),_:1},8,["list","onHandleCurrentChange"])]),_:1})]),_:1},8,["model","rules"])]),page:r(()=>[s("span",{class:"confirm_btn cursor",onClick:e[12]||(e[12]=n=>t(o).submit())},"\u786E\u5B9A")]),_:1},8,["info"]),a(P,{data:{show:t(C).show,point:t(C).point},onBackPoint:t(C).backPoint},null,8,["data","onBackPoint"])])}}};var Ze=F(we,[["__scopeId","data-v-ec8f0f5e"]]);export{Ze as default};
